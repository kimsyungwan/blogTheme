(()=>{const t=document,e=(e,o=t)=>o.querySelector(e),o={style:"auto",size:"md",title:"",escClose:!0,backdropClose:!0,className:""},a=new Set;let s=0;async function n(e){const o=((e,o=t)=>Array.from(o.querySelectorAll(e)))("script",e);for(const s of o){const o=(s.getAttribute("type")||"").trim();if(o&&"text/javascript"!==o&&"module"!==o&&!o.endsWith("/javascript"))continue;const n=s.getAttribute("data-once")||s.getAttribute("src");if(n&&a.has(n))s.remove();else{await new Promise(o=>{const a=t.createElement("script");var n,r;n=s,r=a,Array.from(n.attributes||[]).forEach(t=>{try{r.setAttribute(t.name,t.value)}catch(t){}}),s.src?(a.addEventListener("load",()=>o()),a.addEventListener("error",()=>o()),a.async=!1,t.body.appendChild(a)):(a.textContent=s.textContent||"",e.appendChild(a),o())}),n&&a.add(n);try{s.remove()}catch(t){}}}}function r(o){const a=e("#hy-popup-backdrop");if(!o)return;o.classList.remove("active"),o.classList.add("closing"),a?.classList.remove("show");const n=()=>{o.removeEventListener("transitionend",n);try{o.remove()}catch(t){}if(!e(".hy-popup")){try{a?.remove()}catch(t){}!function(){t.documentElement.classList.remove("hy-popup-open"),t.body.classList.remove("hy-scroll-lock");const e=(()=>{try{return Math.abs(parseInt(t.body.style.top||"0",10))||s||0}catch(t){return s||0}})();t.body.style.position="",t.body.style.top="",t.body.style.left="",t.body.style.right="",t.body.style.width="";try{window.scrollTo(0,e)}catch(t){}}()}};o.addEventListener("transitionend",n),setTimeout(n,350)}function p(){const t=e(".hy-popup.active");t&&r(t)}function c(t){if(!t)return;const o=e(`.hy-popup[data-popup-id="${CSS.escape(t)}"]`);o&&r(o)}async function i(a,r={}){const c={...o,...r},i=function(){let o=e("#hy-popup-backdrop");return o||(o=t.createElement("div"),o.id="hy-popup-backdrop",o.className="hy-popup-backdrop",t.body.appendChild(o)),o}(),u=function(e){const a={...o,...e},s=function(t){return"modal"===t||"sheet"===t?t:function(){try{return window.matchMedia("(max-width: 767px)").matches}catch(t){return!0}}()?"sheet":"modal"}(a.style),n=t.createElement("div");return n.className=`hy-popup hy-popup--${s} hy-size-${a.size}`+(a.className?` ${a.className}`:""),n.setAttribute("role","dialog"),n.setAttribute("aria-modal","true"),n.innerHTML=`\n      <div class="hy-popup__surface">\n        <header class="hy-popup__header">\n          <div class="hy-popup__title" id="hy-popup-title">${a.title?String(a.title):""}</div>\n          <button type="button" class="hy-popup__close" aria-label="Close">Ã—</button>\n        </header>\n        <div class="hy-popup__body" id="hy-popup-body"></div>\n      </div>\n    `,n}(c),d=c.id||`pop-${Math.random().toString(36).slice(2,10)}`;u.dataset.popupId=d,function(){try{s=window.scrollY||window.pageYOffset||0}catch(t){s=0}t.documentElement.classList.add("hy-popup-open"),t.body.classList.add("hy-scroll-lock"),t.body.style.position="fixed",t.body.style.top=`-${s}px`,t.body.style.left="0",t.body.style.right="0",t.body.style.width="100%"}(),t.body.appendChild(u);try{c._autoKey&&(u.dataset.autoKey=String(c._autoKey),u.dataset.autoStorage=String(c._autoStorage||"local"))}catch(t){}const l=u.querySelector(".hy-popup__surface");try{l&&l.getBoundingClientRect()}catch(t){}if(requestAnimationFrame(()=>{u.classList.add("active"),i.classList.add("show")}),c.escClose){const e=o=>{"Escape"===o.key&&(t.removeEventListener("keydown",e),p())};t.addEventListener("keydown",e)}if(c.backdropClose){i.addEventListener("click",t=>{t.target===i&&p()},{once:!0});const t=t=>{t.target===u&&p()};u.addEventListener("click",t,{once:!0})}e(".hy-popup__close",u)?.addEventListener("click",()=>p());const y=e("#hy-popup-body",u)||u;try{const t=await async function(t){const e=await fetch(t,{credentials:"same-origin"});if(!e.ok)throw new Error(`Failed to fetch popup content: ${e.status}`);return e.text()}(a),e=function(t){try{if(/<body[\s\S]*?>[\s\S]*<\/body>/i.test(t)){const e=(new DOMParser).parseFromString(t,"text/html");return e?.body?.innerHTML||t}return t}catch(e){return t}}(t);y.innerHTML=e,await n(y)}catch(t){console.error(t),y.innerHTML='<div class="hy-popup__error">Failed to load content</div>'}}t.addEventListener("click",t=>{const e=t.target&&(t.target.closest?t.target.closest("[data-popup-event]"):null);if(!e)return;const o=e.closest?e.closest(".hy-popup"):null,a=o?.dataset?.popupId||null,s=e.getAttribute("data-popup-event")||"action";let n=null;const r=e.getAttribute("data-popup-payload");if(r)try{n=JSON.parse(r)}catch(t){n=r}const i={id:a,key:o?.dataset?.autoKey||"",name:s,payload:n,trigger:e};try{window.dispatchEvent(new CustomEvent("hy:popup",{detail:i}))}catch(t){}(e.hasAttribute("data-popup-close")||"true"===e.getAttribute("data-popup-close-if"))&&(a?c(a):p())});const u={init:function(){t.__hyPopupInited||(t.__hyPopupInited=!0,t.addEventListener("click",t=>{const e=t.target&&(t.target.closest?t.target.closest("a.popup"):null);if(!e)return;const o=e.getAttribute("href");o&&"#"!==o&&!o.startsWith("javascript:")&&(t.preventDefault(),i(o,{style:e.getAttribute("data-popup-style")||"auto",size:e.getAttribute("data-popup-size")||"md",title:e.getAttribute("data-popup-title")||"",escClose:"false"!==e.getAttribute("data-esc-close"),backdropClose:"false"!==e.getAttribute("data-backdrop-close"),className:e.getAttribute("data-popup-class")||""}))}),t.addEventListener("click",t=>{const o=t.target&&(t.target.closest?t.target.closest("[data-popup-snooze],[data-popup-suppress],[data-popup-dismiss-days]"):null);if(!o)return;const a=e(".hy-popup.active");if(!a)return;const s=a.dataset?.autoKey||"";if(!s)return void p();const n="session"===(a.dataset?.autoStorage||"local").toLowerCase()?window.sessionStorage:window.localStorage,r=o.getAttribute("data-popup-snooze")||o.getAttribute("data-popup-suppress")||o.getAttribute("data-popup-dismiss-days")||o.getAttribute("data-days"),c=Math.max(1,parseInt(r||"7",10)||7),i=Date.now()+24*c*60*60*1e3;try{n.setItem(`hy-popup:auto:suppress:${s}`,String(i))}catch(t){}p()}),function(){if(t.__hyPopupAutoScheduled)return;t.__hyPopupAutoScheduled=!0;const o=()=>{const t=e('meta[name="popup:auto-url"]');if(t&&t.content)return{el:t,url:t.content,fromMeta:!0};const o=e("[data-popup-auto-url], a.popup[data-popup-auto]");if(!o)return null;const a=o.getAttribute("data-popup-auto-url")||o.getAttribute("href");return a?{el:o,url:a,fromMeta:!1}:null},a=Date.now(),s=()=>!(!e('.dynamic-view.active, .dynamic-view.closing, .dynamic-view[data-closing="1"]')&&!e("#dynamic-view-backdrop.show")),n=()=>!!t.__hyPopupAutoAborted,r=()=>{if(n())return!0;if(Date.now()-a>4e3)return!0;if(s())return!1;const t=o();if(!t)return!1;const{el:e,url:r,fromMeta:p}=t,c={style:e.getAttribute?.("data-popup-style")||"auto",size:e.getAttribute?.("data-popup-size")||"md",title:e.getAttribute?.("data-popup-title")||"",escClose:"false"!==e.getAttribute?.("data-esc-close"),backdropClose:"false"!==e.getAttribute?.("data-backdrop-close"),className:e.getAttribute?.("data-popup-class")||""},u=(e.getAttribute?.("data-popup-auto")||"").toLowerCase(),d=(e.getAttribute?.("data-popup-auto-storage")||"local").toLowerCase(),l=e.getAttribute?.("data-popup-auto-key")||r,y="session"===d?window.sessionStorage:window.localStorage;try{if("once"===u&&y.getItem(`hy-popup:auto:${l}`))return!0;if((parseInt(y.getItem(`hy-popup:auto:suppress:${l}`)||"0",10)||0)>Date.now())return!0}catch(t){}const h=parseInt(e.getAttribute?.("data-popup-delay")||"0",10)||0,b=()=>{i(r,{...c,_autoKey:l,_autoStorage:d});try{"once"===u&&y.setItem(`hy-popup:auto:${l}`,"1")}catch(t){}};return h>0?setTimeout(b,h):b(),!0},p=()=>{const e=()=>{t.__hyPopupAutoAborted=!0};if(t.addEventListener("pointerdown",e,{once:!0,capture:!0}),t.addEventListener("click",e,{once:!0,capture:!0}),window.addEventListener("hashchange",e,{once:!0}),r())return;let o=0;const a=Math.ceil(40),s=setInterval(()=>{(n()||r()||++o>=a)&&clearInterval(s)},100);try{const e=new MutationObserver(()=>{(n()||r())&&(e.disconnect(),clearInterval(s))});e.observe(t.body,{childList:!0,subtree:!0}),setTimeout(()=>{try{e.disconnect()}catch(t){}},4500)}catch(t){}window.addEventListener("hashchange",()=>{n()||r()},{once:!0})};"loading"===t.readyState?t.addEventListener("DOMContentLoaded",p,{once:!0}):p()}())},open:i,close:p,closeTop:p,closeById:c,closeFrom:function(t){const e=t&&t.target?t.target:t,o=e&&e.closest?e.closest(".hy-popup"):null;o?r(o):p()},getTopId:()=>e(".hy-popup.active")?.dataset?.popupId||null};try{window.Popup=u}catch(t){}})();